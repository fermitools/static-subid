# =============================================================================
# PRIMARY UID RANGE
# =============================================================================
# Controls which users are eligible for subordinate ID assignment.
# Only users with UIDs in [UID_MIN, UID_MAX] will be processed.
#
# Minimum UID eligible for subordinate ID assignment
# Range: [1, UINT32_MAX]
#UID_MIN 1000

# Maximum UID eligible for subordinate ID assignment
# Range: [UID_MIN, UINT32_MAX]
#
# IMPORTANT: This does NOT limit how high UIDs can go in your environment.
# It only limits which UIDs this tool will assign subordinate ranges to.
#UID_MAX 60000

# =============================================================================
# SUBORDINATE UID CONFIGURATION
# =============================================================================
# Defines the pool of subordinate UIDs available for container mapping.
#
# Each user receives a contiguous block of SUB_UID_COUNT subordinate UIDs.
# This range is always deterministic based on the user's primary UID.

# Minimum subordinate UID value
# Range: [UID_MAX + 1, UINT32_MAX - SUB_UID_COUNT]
#SUB_UID_MIN 100000

# Maximum subordinate UID value
# Range: [SUB_UID_MIN + SUB_UID_COUNT - 1, UINT32_MAX]
#SUB_UID_MAX 4294967294

# Number of subordinate UIDs per user
#
# SIZING GUIDANCE:
# - 65536: Standard choice, allows full 16-bit UID space inside containers
#          Sufficient for most workloads (base images, dev environments)
# - 131072 (2^17): For containers with many distinct UIDs
# - 1048576 (2^20): For complex multi-tenant or nested container scenarios
#
# IMPORTANT: Increasing SUB_UID_COUNT reduces maximum supported users.
#SUB_UID_COUNT 65536

# =============================================================================
# SUBORDINATE GID CONFIGURATION
# =============================================================================
# Defines the pool of subordinate GIDs available for container mapping.
# Configuration semantics are identical to subordinate UIDs.
#
# TYPICAL PRACTICE:
# Use the same values as subordinate UIDs unless you have a specific reason
# to diverge (e.g., different allocation ratios, separate pools for UID/GID).

# Minimum subordinate GID value
#SUB_GID_MIN 100000

# Maximum subordinate GID value
#SUB_GID_MAX 4294967294

# Number of subordinate GIDs per user
#SUB_GID_COUNT 65536

# =============================================================================
# OPERATIONAL BEHAVIOR
# =============================================================================

# Skip assignment if user already has subordinate IDs
# Values: true, false
#
# WHEN ENABLED (true):
# - Checks existing subordinate IDs using getsubids(1)
# - Skips assignment if any subordinate IDs already exist
# - Prevents accidental modification of manual assignments
# - Safe for repeated invocations (idempotent)
#
# WHEN DISABLED (false):
# - Always attempts assignment via usermod --add-subuids / --add-subgids
# - usermod will append new ranges without removing existing ones
# - Can result in users having multiple subordinate ID ranges
# - Useful for migration or manual range management
#
# RECOMMENDED: true (prevents unexpected range proliferation)
#SKIP_IF_EXISTS true

# Allow subordinate ID range wrapping
# Values: true, false
#
# WARNING: ENABLING THIS CREATES SECURITY RISKS!
# WARNING: ENABLING THIS MAY CAUSE RANGE OVERLAPS!
# WARNING: ENABLING THIS MAY ENABLE CONTAINER ESCAPES!
#
# WHEN DISABLED (false) - STRICT MODE:
# - Range calculation must fit cleanly without overflow
# - Any arithmetic overflow is a fatal error
# - Guarantees non-overlapping, monotonic allocation
# - RECOMMENDED FOR PRODUCTION
#
# WHEN ENABLED (true) - WRAP MODE:
# - Treats subordinate ID space as a ring buffer
# - Uses modulo arithmetic to handle overflow
# - May cause range overlaps if space is exhausted
# - INTENDED ONLY FOR: development, testing, constrained lab environments
#
# OVERLAP EXAMPLE (why this is dangerous):
# With SUB_UID_MIN=100000, SUB_UID_MAX=200000, SUB_UID_COUNT=65536:
#   Space available: 100001 subordinate UIDs
#   Max users without overlap: 1 user
#
# If ALLOW_SUBID_WRAP=true:
#   User A (UID 1000): range [100000, 165535]
#   User B (UID 1001): range [165536, 231071] â†’ WRAPS to [100000, 65535]
#   User A and B now SHARE subordinate UIDs 100000-165535!
#
# CONTAINER ESCAPE SCENARIO:
#   User A runs container as UID 0 (maps to subuid 100000)
#   User B runs container as UID 0 (ALSO maps to subuid 100000)
#   User B's container can now access User A's files!
#
# DO NOT ALLOW ALLOW_SUBID_WRAP UNLESS YOU FULLY UNDERSTAND THE IMPLICATIONS!
ALLOW_SUBID_WRAP false
